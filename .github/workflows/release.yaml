name: Release

on:
  push:
    branches:
      - main
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:

  release-please:
    runs-on: ubuntu-latest
    steps:
      - name: Run release-please
        id: release
        uses: googleapis/release-please-action@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          config-file: .github/release-please/config.json
          manifest-file: .github/release-please/manifest.json

#  release-core:
#    uses: matter-labs/zksync-ci-common/.github/workflows/release-plz.yaml@v1
#    secrets:
#      gh_token: ${{ secrets.GITHUB_TOKEN }}
#      cargo_registry_token: ${{ secrets.CRATES_IO_TOKEN }}
#      slack_webhook: ${{ secrets.SLACK_WEBHOOK }}
#    with:
#      manifest_path: 'Cargo.toml'
#      config: 'release-plz.toml'
#      concurrency-suffix: 'core'
#      org-owner: 'antonbaliasnikov'

#  release-prover:
#    uses: matter-labs/zksync-ci-common/.github/workflows/release-plz.yaml@v1
#    secrets:
#      gh_token: ${{ secrets.GITHUB_TOKEN }}
#      cargo_registry_token: ${{ secrets.CRATES_IO_TOKEN }}
#      slack_webhook: ${{ secrets.SLACK_WEBHOOK }}
#    with:
#      manifest_path: 'prover/Cargo.toml'
#      config: 'prover/release-plz.toml'
#      concurrency-suffix: 'prover'
#      org-owner: 'antonbaliasnikov'
